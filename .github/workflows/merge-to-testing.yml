name: Merge main into testing/Live
run-name: ${{ github.actor }} is merging main ğŸš€
on: 
  workflow_dispatch:
    inputs:
      targetBranch:
        description: 'Target Branch'
        required: true
        default: 'testing'
        type: choice
        options:
        - testing
        - live
      force:
        description: 'Force sync (hard reset to main)'
        required: true
        default: false
        type: boolean
jobs:
  manual_merge:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - run: echo "ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "ğŸ–¥ï¸ The workflow is now ready to test your code on the runner."
      - name: Attempt the merge
        run: |
          git checkout ${{ inputs.targetBranch }}
          git merge main --ff-only
      - name: Force merge if necessary
        if: failure() and ${{ inputs.force }}
        run: |
          git checkout live
          git reset --hard main
          git push --force
      - name: Push
        run: |
          git push      
      - run: echo "ğŸ This job's status is ${{ job.status }}."
